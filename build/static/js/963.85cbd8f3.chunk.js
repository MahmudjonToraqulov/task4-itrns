"use strict";(self.webpackChunkreact_firebase_auth=self.webpackChunkreact_firebase_auth||[]).push([[963],{963:(e,t,r)=>{r.r(t),r.d(t,{default:()=>x});var s=r(43),l=r(317),a=r(472),d=r(929),o=r(910),n=r(216),c=r(797),i=r(813),b=r(579);const x=()=>{const e=(0,n.Zp)(),{currentUser:t}=(0,i.A)(),[r,x]=(0,s.useState)([]),[h,u]=(0,s.useState)(new Set),m=(0,s.useRef)(null),[g,j]=(0,s.useState)(null);(0,s.useEffect)((()=>{const e=(0,c.hg)(l.j,(e=>{j(e?e.uid:null)})),t=(0,a.P)((0,a.rJ)(l.db,"users")),r=(0,a.aQ)(t,(e=>{const t=e.docs.map((e=>({id:e.id,...e.data()})));x(t)}));return()=>{r(),e()}}),[]);const p=async t=>{await(0,a.mZ)((0,a.H9)(l.db,"users",t),{status:"blocked"}),t===g&&(await(0,c.CI)(l.j),e("/login"))},f=async e=>{await(0,a.mZ)((0,a.H9)(l.db,"users",e),{status:"active"})},N=async t=>{const r=l.j.currentUser;if(!r)throw new Error("No user is currently logged in.");try{await(0,a.kd)((0,a.H9)(l.db,"users",t)),t===r.uid&&(await(0,c.hG)(r),await(0,c.CI)(l.j),e("/login"))}catch(s){throw console.error("Error deleting user:",s),new Error("Failed to delete user account. "+s.message)}};return(0,s.useEffect)((()=>{m.current&&(m.current.indeterminate=h.size>0&&h.size<r.length)}),[h,r.length]),r.sort(((e,t)=>t.lastLoginTime.toMillis()-e.lastLoginTime.toMillis())),(0,b.jsxs)("div",{className:"container mt-20 mx-auto",children:[(0,b.jsx)("h2",{className:"my-2 text-3xl text-green-700",children:"User Management"}),(0,b.jsxs)("table",{className:"table w-full border-collapse border border-2 border-slate-500 border-spacing-2  hover:border-spacing-2mt-6 mb-2",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"border border-slate-600 border-2 p-5 \t",children:(0,b.jsx)("input",{className:"scale-150",type:"checkbox",onChange:()=>{if(h.size===r.length)u(new Set);else{const e=new Set(r.map((e=>e.id)));u(e)}console.log(h)},checked:h.size===r.length,ref:m})}),(0,b.jsx)("th",{className:"border border-slate-600 border-2 px-2 text-lg",children:"Name"}),(0,b.jsx)("th",{className:"border border-slate-600 border-2 text-lg",children:"Email"}),(0,b.jsx)("th",{className:"border border-slate-600 border-2 text-lg",children:"Last Login"}),(0,b.jsx)("th",{className:"border border-slate-600 border-2 text-lg",children:"Registration Time"}),(0,b.jsx)("th",{className:"border border-slate-600 border-2 text-lg",children:"Status"}),(0,b.jsx)("th",{className:"border border-slate-600 border-2 text-lg",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:r.map((e=>{var t,r;return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"text-center border border-slate-600 p-5 border-2 ",children:(0,b.jsx)("input",{className:"scale-150",type:"checkbox",onChange:()=>(e=>{const t=new Set(h);t.has(e)?t.delete(e):t.add(e),u(t)})(e.id),checked:h.has(e.id)})}),(0,b.jsx)("td",{className:"text-center border border-slate-600 p-2 border-2",children:e.name}),(0,b.jsx)("td",{className:"text-center border border-slate-600 p-2 border-2",children:e.email}),(0,b.jsx)("td",{className:"text-center border border-slate-600 p-2 border-2",children:null===(t=e.lastLoginTime)||void 0===t?void 0:t.toDate().toString()}),(0,b.jsx)("td",{className:"text-center border border-slate-600 p-2 border-2",children:null===(r=e.registrationTime)||void 0===r?void 0:r.toDate().toString()}),(0,b.jsx)("td",{className:"active"===e.status?"text-center border border-slate-700 p-2 border-2 text-lg font-semibold text-green-700":"text-center border border-slate-700 p-2 border-2 text-lg font-semibold text-red-700\t",children:e.status}),(0,b.jsxs)("td",{className:"text-center border border-slate-600 p-2  flex",children:[(0,b.jsx)("button",{className:"active"===e.status?"mx-1 my-1 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded":"mx-1 my-1 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",onClick:()=>"active"===e.status?p(e.id):f(e.id),children:"active"===e.status?"Block":(0,b.jsx)(o.g,{icon:d.KKb,title:"Unblock"})}),(0,b.jsx)("button",{className:"mx-1 my-1 bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",onClick:()=>N(e.id),children:"Delete"})]})]},e.id)}))})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between ",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("button",{className:"mx-1 my-1 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:()=>h.forEach(p),children:"Block Selected"}),(0,b.jsx)("button",{className:"mx-1 my-1 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",onClick:()=>h.forEach(f),children:(0,b.jsx)(o.g,{icon:d.KKb,title:"Unblock"})}),(0,b.jsx)("button",{className:"mx-1 my-1 bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",onClick:()=>h.forEach(N),children:"Delete Selected"})]}),(0,b.jsxs)("h2",{className:"text-white text-lg p-2 bg-indigo-500",children:[" Current User - ",t.email," "]})]})]})}}}]);
//# sourceMappingURL=963.85cbd8f3.chunk.js.map